Speeduino 是一个开源的发动机控制单元（ECU），其工作原理基于实时采集传感器数据，通过固件算法处理，并控制执行器以实现对燃油喷射、点火时机等关键参数的精确管理。以下是其核心工作原理的总结：

## 1. 硬件架构
### 主控单元
基于 Arduino（如 Mega 2560）或 Teensy 等开发板，负责运行 Speeduino 固件。

### 输入接口
支持多种传感器信号，包括：
- **曲轴/凸轮轴位置传感器**（触发信号，如 36-1 缺齿轮、双轮触发等）。
- **温度传感器**（冷却液温度 CLT、进气温度 IAT）。
- **压力传感器**（MAP、Baro）。
- **节气门位置传感器（TPS）、氧传感器（O2）**等。

### 输出接口
- **喷油器驱动**：支持 4 通道喷油控制，可配置为顺序喷射或分组喷射。
- **点火驱动**：支持 4 通道点火输出，适配浪费式点火（Wasted Spark）、顺序点火（COP）等模式。
- **辅助输出**：如怠速控制阀（PWM/步进电机）、增压控制、风扇控制等。

## 2. 固件功能
### 触发同步
通过曲轴和凸轮轴信号确定发动机位置和转速。支持多种触发模式（如 Missing Tooth、Dual Wheel、Basic Distributor），确保准确的相位识别。

### 燃油计算
- 基于 **VE 表（容积效率表）**，根据转速和负载（MAP 或 TPS）计算喷油量。
- 支持 **闭环燃油控制**（通过氧传感器反馈调整空燃比）。
- 支持 **多级喷油（Staged Injection）** 和 **乙醇燃料补偿（Flex Fuel）**。

### 点火控制
- 根据 **转速、负载和温度** 动态调整点火提前角。
- 支持 **爆震检测和软/硬限速保护**。

### 怠速控制
通过 PWM 或步进电机调节怠速阀，维持目标转速。

### 扩展功能
如 **增压控制、氮氧控制、变速箱检测（VSS）**等。

## 3. 软件交互
**Tuner Studio**：用于参数配置、实时监控和数据记录。用户可通过该软件：
- 设置发动机常数（气缸数、冲程类型等）。
- 调校燃油和点火表（VE Table、点火提前表）。
- 启用或配置扩展功能（如闭式循环控制、怠速 PID 调节）。

## 4. 关键流程
1. **信号采集**：传感器数据（如曲轴转速、进气压力、节气门开度）通过模拟/数字输入通道传入 ECU。
2. **数据处理**：固件根据预设算法（如 MAP 采样方法、触发边沿检测）解析信号，确定发动机状态（转速、负载、相位）。
3. **查表计算**：基于 VE 表和点火表，结合实时修正（如温度补偿、加速增浓），计算喷油脉宽和点火时机。
4. **执行控制**：通过输出接口驱动喷油器、点火线圈等执行器，实现精确的燃油喷射和点火。
5. **闭环反馈**：氧传感器、爆震传感器等提供实时反馈，动态调整控制参数以优化性能。

## 5. 核心优势
- **灵活性**：支持多种触发模式、喷油/点火策略，适配不同发动机类型（四缸、六缸、转子发动机等）。
- **开源可定制**：硬件和固件均为开源设计，用户可根据需求修改电路或调整算法。
- **低成本**：基于通用开发板（如 Arduino）和标准化传感器，显著降低 ECU 部署成本。

## 6. 典型应用场景
- **改装车辆**（如加装涡轮增压后的燃油/点火优化）。
- **经典老车**（替换原厂机械式分电器）。
- **实验性发动机开发**（快速原型验证）。

通过模块化设计和开放生态，Speeduino 为发动机控制提供了高度可定制且经济高效的解决方案，广泛应用于汽车改装和工程测试领域。
